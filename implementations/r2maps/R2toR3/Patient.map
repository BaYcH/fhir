map "http://hl7.org/fhir/StructureMap/Patient2to3" = "R2 to R3 Conversions for Patient"

uses "http://hl7.org/fhir/DSTU2/StructureDefinition/Patient" alias PatientR2 as source
uses "http://hl7.org/fhir/StructureDefinition/Patient" alias Patient as target

imports "http://hl7.org/fhir/StructureMap/primitives2to3"
imports "http://hl7.org/fhir/StructureMap/DomainResource2to3"
imports "http://hl7.org/fhir/StructureMap/Address2to3"
imports "http://hl7.org/fhir/StructureMap/Attachment2to3"
imports "http://hl7.org/fhir/StructureMap/HumanName2to3"
imports "http://hl7.org/fhir/StructureMap/ContactPoint2to3"
imports "http://hl7.org/fhir/StructureMap/Identifier2to3"
imports "http://hl7.org/fhir/StructureMap/Reference2to3"
imports "http://hl7.org/fhir/StructureMap/CodeableConcept2to3"

group for type+types  Patient extends DomainResource
  input src : PatientR2 as source
  input tgt : Patient as target

  "Patient-identifier" : for src.identifier make tgt.identifier
  "Patient-active" : for src.active make tgt.active
  "Patient-name" : for src.name make tgt.name
  "Patient-telecom" : for src.telecom make tgt.telecom
  "Patient-gender" : for src.gender make tgt.gender
  "Patient-birthDate" : for src.birthDate make tgt.birthDate
  "Patient-deceased-boolean" : for src.deceased : boolean as vs make tgt.deceased = create("boolean") as vt then boolean(vs, vt)
  "Patient-deceased-dateTime" : for src.deceased : dateTime as vs make tgt.deceased = create("dateTime") as vt then dateTime(vs, vt)
  "Patient-address" : for src.address make tgt.address
  "Patient-maritalStatus" : for src.maritalStatus make tgt.maritalStatus
  "Patient-multipleBirth-boolean" : for src.multipleBirth : boolean as vs make tgt.multipleBirth = create("boolean") as vt then boolean(vs, vt)
  "Patient-multipleBirth-integer" : for src.multipleBirth : integer as vs make tgt.multipleBirth = create("integer") as vt then integer(vs, vt)
  "Patient-photo" : for src.photo make tgt.photo
  "Patient-communication" : for src.communication as vs0 make tgt.communication as vt0 then {
    "Patient.communication-language" : for vs0.language make vt0.language
    "Patient.communication-preferred" : for vs0.preferred make vt0.preferred
  }

  "Patient-generalPractitioner" : for src.careProvider make tgt.generalPractitioner
  "Patient-managingOrganization" : for src.managingOrganization make tgt.managingOrganization
  "Patient-link" : for src.link as vs0 make tgt.link as vt0 then {
    "Patient.link-other" : for vs0.other make vt0.other
    "Patient.link-type" : for vs0.type make vt0.type
  }


endgroup
