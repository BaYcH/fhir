map "http://hl7.org/fhir/StructureMap/Bundle2to3" = "R2 to R3 Conversions for Bundle"

uses "http://hl7.org/fhir/DSTU2/StructureDefinition/Bundle" alias BundleR2 as source
uses "http://hl7.org/fhir/StructureDefinition/Bundle" alias Bundle as target

imports "http://hl7.org/fhir/StructureMap/primitives2to3"
imports "http://hl7.org/fhir/StructureMap/Resource2to3"
imports "http://hl7.org/fhir/StructureMap/Signature2to3"

group for type+types  Bundle extends Resource
  input src : BundleR2 as source
  input tgt : Bundle as target

  "Bundle-type" : for src.type make tgt.type
  "Bundle-total" : for src.total make tgt.total
  "Bundle-link" : for src.link as vs0 make tgt.link as vt0 then {
    "Bundle.link-relation" : for vs0.relation make vt0.relation
    "Bundle.link-url" : for vs0.url make vt0.url
  }

  "Bundle-entry" : for src.entry as vs0 make tgt.entry as vt0 then {
    "Bundle.entry-fullUrl" : for vs0.fullUrl make vt0.fullUrl
  }

  "Bundle-signature" : for src.signature make tgt.signature

endgroup
