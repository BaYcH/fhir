map "http://hl7.org/fhir/StructureMap/Composition3to2" = "R3 to R2 Conversion for Composition"

uses "http://hl7.org/fhir/StructureDefinition/Composition" alias Composition as source
uses "http://hl7.org/fhir/DSTU2/StructureDefinition/Composition" alias CompositionR2 as target

imports "http://hl7.org/fhir/StructureMap/primitives3to2"
imports "http://hl7.org/fhir/StructureMap/DomainResource3to2"
imports "http://hl7.org/fhir/StructureMap/Identifier3to2"
imports "http://hl7.org/fhir/StructureMap/Reference3to2"
imports "http://hl7.org/fhir/StructureMap/Period3to2"
imports "http://hl7.org/fhir/StructureMap/CodeableConcept3to2"

group for type+types  Composition extends DomainResource
  input src : Composition as source
  input tgt : CompositionR2 as target

  "Composition-identifier" : for src.identifier make tgt.identifier
  "Composition-date" : for src.date make tgt.date
  "Composition-type" : for src.type make tgt.type
  "Composition-class" : for src.class make tgt.class
  "Composition-title" : for src.title make tgt.title
  "Composition-status" : for src.status make tgt.status
  "Composition-subject" : for src.subject make tgt.subject
  "Composition-author" : for src.author make tgt.author
  "Composition-attester" : for src.attester as vs0 make tgt.attester as vt0 then {
    "Composition.attester-time" : for vs0.time make vt0.time
    "Composition.attester-party" : for vs0.party make vt0.party
  }

  "Composition-custodian" : for src.custodian make tgt.custodian
  "Composition-event" : for src.event as vs0 make tgt.event as vt0 then {
    "Composition.event-code" : for vs0.code make vt0.code
    "Composition.event-period" : for vs0.period make vt0.period
    "Composition.event-detail" : for vs0.detail make vt0.detail
  }

  "Composition-encounter" : for src.encounter make tgt.encounter

endgroup
