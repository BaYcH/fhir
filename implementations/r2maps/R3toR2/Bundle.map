map "http://hl7.org/fhir/StructureMap/Bundle3to2" = "R3 to R2 Conversion for Bundle"

uses "http://hl7.org/fhir/StructureDefinition/Bundle" alias Bundle as source
uses "http://hl7.org/fhir/DSTU2/StructureDefinition/Bundle" alias BundleR2 as target

imports "http://hl7.org/fhir/StructureMap/primitives3to2"
imports "http://hl7.org/fhir/StructureMap/Resource3to2"
imports "http://hl7.org/fhir/StructureMap/Signature3to2"

group for type+types  Bundle extends Resource
  input src : Bundle as source
  input tgt : BundleR2 as target

  "Bundle-type" : for src.type make tgt.type
  "Bundle-total" : for src.total make tgt.total
  "Bundle-link" : for src.link as vs0 make tgt.link as vt0 then {
    "Bundle.link-relation" : for vs0.relation make vt0.relation
    "Bundle.link-url" : for vs0.url make vt0.url
  }

  "Bundle-entry" : for src.entry as vs0 make tgt.entry as vt0 then {
    "Bundle.entry-fullUrl" : for vs0.fullUrl make vt0.fullUrl
  }

  "Bundle-signature" : for src.signature make tgt.signature

endgroup
