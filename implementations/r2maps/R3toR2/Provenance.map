map "http://hl7.org/fhir/StructureMap/Provenance3to2" = "R3 to R2 Conversion for Provenance"


uses "http://hl7.org/fhir/StructureDefinition/Provenance" alias Provenance as source
uses "http://hl7.org/fhir/DSTU2/StructureDefinition/Provenance" alias ProvenanceR2 as target

imports "http://hl7.org/fhir/StructureMap/primitives3to2"
imports "http://hl7.org/fhir/StructureMap/Coding3to2"
imports "http://hl7.org/fhir/StructureMap/Reference3to2"
imports "http://hl7.org/fhir/StructureMap/Period3to2"
imports "http://hl7.org/fhir/StructureMap/Signature3to2"



group Provenance extends Element
  input src : Provenance as source
  input tgt : ProvenanceR2 as target
  "Provenance-target" : for src.target as vs make tgt.target as vt then Reference(vs,vt)
  "Provenance-period" : for src.period as vs make tgt.period as vt then Period(vs,vt)
  "Provenance-recorded" : for src.recorded as vs make tgt.recorded as vt then instant(vs, vt)
  "Provenance-location" : for src.location as vs make tgt.location as vt then Reference(vs,vt)
  "Provenance-policy" : for src.policy as vs make tgt.policy as vt then uri(vs, vt)
  "Provenance-agent" : for src.agent as vs0 make tgt.agent as vt0 then {
    "Provenance.agent-role" : for vs0.role as vs make vt0.role as vt then Coding(vs,vt)
    "Provenance.agent-actor" : for vs0.whoReference as vs make vt0.actor as vt then Reference(vs,vt)
  }
  "Provenance-entity" : for src.entity as vs0 make tgt.entity as vt0 then {
    "Provenance.entity-role" : for vs0.role as vs make vt0.role as vt then code(vs, vt)
  }
  "Provenance-signature" : for src.signature as vs make tgt.signature as vt then Signature(vs,vt)
endgroup

