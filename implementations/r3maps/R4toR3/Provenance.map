map "http://hl7.org/fhir/StructureMap/Provenance4to3" = "R4 to R3 Conversion for Provenance"


uses "http://hl7.org/fhir/StructureDefinition/Provenance" alias Provenance as source
uses "http://hl7.org/fhir/3.0/StructureDefinition/Provenance" alias ProvenanceR3 as target

imports "http://hl7.org/fhir/StructureMap/*4to3"



group for type+types Provenance extends DomainResource
  input src : Provenance as source
  input tgt : ProvenanceR3 as target

  "Provenance.target" : for src.target make tgt.target 
  "Provenance.period" : for src.occurredPeriod make tgt.period 
  "Provenance.recorded" : for src.recorded make tgt.recorded 
  "Provenance.policy" : for src.policy make tgt.policy 
  "Provenance.location" : for src.location make tgt.location 
  "Provenance.activity" : for src.activity make tgt.activity 
  "Provenance.agent" : for src.agent as vs0 make tgt.agent as vt0 then {
    "Provenance.agent.role" : for vs0.role make vt0.role 
    "Provenance.agent.who-Reference" : for vs0.who : Reference as vs make vt0.who = create("Reference") as vt then Reference(vs,vt)
    "Provenance.agent.onBehalfOf-Reference" : for vs0.onBehalfOf : Reference as vs make vt0.onBehalfOf = create("Reference") as vt then Reference(vs,vt)
  }
  "Provenance.entity" : for src.entity as vs0 make tgt.entity as vt0 then {
    "Provenance.entity.role" : for vs0.role make vt0.role 
    "Provenance.entity.what-Reference" : for vs0.what : Reference as vs make vt0.what = create("Reference") as vt then Reference(vs,vt)
  }
  "Provenance.signature" : for src.signature make tgt.signature 
endgroup

