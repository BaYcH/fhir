<?xml version="1.0" encoding="UTF-8"?>
<!--file name: observation-lsatn-query/xml 

The response from an lastn query is a set of observations, grouped by code, filtered by additional parameters, sorted from most recent to the oldest and limited to the number of requested responses per group ( e.g. 1 or 5 ) which is specified by the optional max query parameter. If no maximum number is given then only the most recent Observation in each group is returned. The set of returned observations should represent distinct real world observations and not the same observation with changes in status or versions. If there are no matches, the lastn SHALL return an empty search set with no error, but may include an operation outcome with further advice.

One optional parameter to the lastn match operation is max, which is used to specify the number of Observations to return from each group. This SHALL be used by the server to restrict the number possible matches that are returned.

-->
<OperationDefinition xmlns="http://hl7.org/fhir">
	<id value="observation-lastn"/>

	<url value="http://hl7.org/fhir/OperationDefinitino/observation-lastn"/>
	<name value="Last N Observations Query"/>
	<status value="draft"/>
	<kind value="query"/>
	<experimental value="false"/>
	<date value="2017-02-18"/>
	<publisher value="HL7 Orders and Observations Workgroup"/>
	<contact>
		<telecom>
			<system value="url"/>
			<value value="http://hl7.org/fhir"/>
		</telecom>
	</contact>
	<description value="The response from an lastn query is a set of observations, grouped by code, filtered by additional parameters, sorted from most recent to the oldest and limited to the number of requested responses per group ( e.g. 1 or 5 ) which is specified by the optional max query parameter. If no maximum number is given then only the most recent Observation in each group is returned. The set of returned observations should represent distinct real world observations and not the same observation with changes in status or versions. If there are no matches, the lastn SHALL return an empty search set with no error, but may include an operation outcome with further advice."/>
	<purpose value="The lastn query meets the common need for searching for the most recent or 'last known' Observations for a subject. For example retrieving the last 5 temperatures for a patient to view trends or fetching the most recent laboratory results or vitals signs."/>
	<idempotent value="true"/>
	<code value="mpi"/>
	<comment value="To ask a server to return the last n=number of observations, clients use the lastn query, which uses the normal search parameters defined for observation. However, rather than their normal use, they are interpreted as inputs - e.g. instead of requiring that the resources literally contain the search parameters, they are passed to a server algorithm of some kind that uses them to determine the most appropriate matches."/>
	<resource value="Observation"/>
	<system value="false"/>
	<type value="true"/>
	<instance value="false"/>
	<!--   in addition to all the standard patient parameters, this one:   -->
	<parameter>
		<name value="max"/>
		<use value="in"/>
		<min value="0"/>
		<max value="1"/>
		<documentation value="One optional parameter to the lastn match operation is max, which is used to specify the number of Observations to return from each group. This SHALL be used by the server to restrict the number possible matches that are returned"/>
		<type value="positiveInt"/>
	</parameter>
	<!--   return the most current n observations -->
	<parameter>
		<name value="result"/>
		<use value="out"/>
		<min value="0"/>
		<max value="*"/>
		<documentation value="The most recent n observations grouped by code that match search criteria"/>
		<type value="Observation"/>
	</parameter>
</OperationDefinition>
